<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>LRU Cache Visualizer - Advanced Animations</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <h1><i class="fas fa-memory"></i> LRU Cache Visualizer</h1>
    <p class="subtitle">Interactive demonstration with advanced animations, particle effects, and sound feedback</p>
  </header>

  <div class="main-container">
    <!-- Controls Panel -->
    <div class="panel">
      <h2 class="panel-title"><i class="fas fa-sliders-h"></i> Controls</h2>
      
      <div class="controls-section">
        <h3><i class="fas fa-cog"></i> Configuration</h3>
        <div class="input-group">
          <div class="input-field">
            <label>Cache Capacity</label>
            <input id="capacityInput" type="number" min="1" value="3" />
          </div>
          <button id="setCapacity" class="btn btn-secondary">
            <i class="fas fa-check"></i> Set
          </button>
        </div>
      </div>

      <div class="controls-section">
        <h3><i class="fas fa-database"></i> Operations</h3>
        <div class="input-group">
          <div class="input-field">
            <label>Key</label>
            <input id="keyInput" type="text" placeholder="e.g. 1" />
          </div>
          <div class="input-field">
            <label>Value</label>
            <input id="valueInput" type="text" placeholder="e.g. 10" />
          </div>
        </div>
        
        <div class="button-group">
          <button id="putBtn" class="btn btn-primary">
            <i class="fas fa-plus"></i> Put
          </button>
          <button id="getBtn" class="btn btn-primary">
            <i class="fas fa-search"></i> Get
          </button>
          <button id="resetBtn" class="btn btn-secondary">
            <i class="fas fa-refresh"></i> Reset
          </button>
        </div>
      </div>

      <div class="controls-section">
        <h3><i class="fas fa-play"></i> Execution</h3>
        <div class="button-group">
          <button id="stepBtn" class="btn btn-secondary" disabled>
            <i class="fas fa-step-forward"></i> Step
          </button>
          <button id="runBtn" class="btn btn-secondary" disabled>
            <i class="fas fa-play"></i> Run
          </button>
        </div>
        
        <div class="speed-control">
          <label>Animation Speed</label>
          <input id="speed" type="range" class="speed-slider" min="100" max="2000" step="100" value="600" />
        </div>

        <div class="sound-controls">
          <label class="sound-toggle">
            <input type="checkbox" id="soundToggle" />
            <i class="fas fa-volume-mute sound-icon" id="soundIcon"></i>
            <span>Sound Effects</span>
          </label>
        </div>
      </div>

      <div class="controls-section">
        <h3><i class="fas fa-list"></i> Batch Operations</h3>
        <div class="input-field">
          <textarea id="batchInput" rows="4" placeholder="put 1 10, put 2 20, get 1, put 3 30"></textarea>
        </div>
        <div class="button-group">
          <button id="runBatchBtn" class="btn btn-primary">
            <i class="fas fa-play-circle"></i> Run Batch
          </button>
          <button id="clearLogBtn" class="btn btn-secondary">
            <i class="fas fa-trash"></i> Clear Log
          </button>
        </div>
      </div>

      <div class="controls-section">
        <h3><i class="fas fa-info-circle"></i> Legend</h3>
        <div class="legend">
          <div class="legend-item hit">
            <i class="fas fa-check-circle"></i> Hit
          </div>
          <div class="legend-item miss">
            <i class="fas fa-times-circle"></i> Miss
          </div>
          <div class="legend-item evict">
            <i class="fas fa-exclamation-triangle"></i> Evict
          </div>
        </div>
      </div>
    </div>

    <!-- Visualization Panel -->
    <div class="panel">
      <h2 class="panel-title"><i class="fas fa-eye"></i> Advanced Cache Visualization</h2>
      
      <div class="cache-container">
        <h3>Cache State (MRU → LRU)</h3>
        <div id="cacheVisual" class="cache-visual">
          <div class="empty-state">
            <i class="fas fa-database"></i>
            <p>Cache is empty</p>
          </div>
        </div>
      </div>

      <div class="map-container">
        <h3><i class="fas fa-sitemap"></i> Hash Map (Key → Node)</h3>
        <div id="mapView" class="map-visual">
          <div class="empty-state">
            <i class="fas fa-map"></i>
            <p>No mappings</p>
          </div>
        </div>
      </div>

      <div class="log-container">
        <h3><i class="fas fa-terminal"></i> Execution Log</h3>
        <div id="logView"></div>
      </div>
    </div>

    <!-- Code Panel -->
    <div class="panel">
      <div class="code-container">
        <div class="code-header">
          <div class="code-dots">
            <div class="dot red"></div>
            <div class="dot yellow"></div>
            <div class="dot green"></div>
          </div>
          <div class="code-title">LRUCache.java</div>
        </div>
        <pre id="codePane" class="code"><code><span data-line="ln1">public class Node {</span>
<span data-line="ln2">    int key;</span>
<span data-line="ln3">    int value;</span>
<span data-line="ln4">    Node prev;</span>
<span data-line="ln5">    Node next;</span>
<span data-line="ln6">    public Node(int key, int value) {</span>
<span data-line="ln7">        this.key = key;</span>
<span data-line="ln8">        this.value = value;</span>
<span data-line="ln9">    }</span>
<span data-line="ln10">}</span>

<span data-line="ln11">public class LRUCache {</span>
<span data-line="ln12">    private Node head;</span>
<span data-line="ln13">    private Node tail;</span>
<span data-line="ln14">    private Map&lt;Integer, Node&gt; m;</span>
<span data-line="ln15">    private int capacity;</span>
<span data-line="ln16">    public LRUCache(int capacity) {</span>
<span data-line="ln17">        this.capacity = capacity;</span>
<span data-line="ln18">        m = new HashMap&lt;&gt;();</span>
<span data-line="ln19">        head = new Node(0,0); // dummy</span>
<span data-line="ln20">        tail = new Node(0,0); // dummy</span>
<span data-line="ln21">        head.next = tail;</span>
<span data-line="ln22">        tail.prev = head;</span>
<span data-line="ln23">    }</span>

<span data-line="ln24">    public int get(int key) {</span>
<span data-line="ln25">        if (!m.containsKey(key)) return -1;</span>
<span data-line="ln26">        Node node = m.get(key);</span>
<span data-line="ln27">        delete(node);</span>
<span data-line="ln28">        insert(node);</span>
<span data-line="ln29">        return node.value;</span>
<span data-line="ln30">    }</span>

<span data-line="ln31">    public void put(int key, int value) {</span>
<span data-line="ln32">        if (m.containsKey(key)) {</span>
<span data-line="ln33">            Node node = m.get(key);</span>
<span data-line="ln34">            node.value = value;</span>
<span data-line="ln35">        delete(node);</span>
<span data-line="ln36">        insert(node);</span>
<span data-line="ln37">        return;</span>
<span data-line="ln38">        }</span>
<span data-line="ln39">        if (m.size() == capacity) {</span>
<span data-line="ln40">            Node toRemove = tail.prev;</span>
<span data-line="ln41">            delete(toRemove);</span>
<span data-line="ln42">            m.remove(toRemove.key);</span>
<span data-line="ln43">        }</span>
<span data-line="ln44">        Node node = new Node(key, value);</span>
<span data-line="ln45">        insert(node);</span>
<span data-line="ln46">        m.put(key, node);</span>
<span data-line="ln47">    }</span>

<span data-line="ln48">    private void insert(Node node) {</span>
<span data-line="ln49">        node.next = head.next;</span>
<span data-line="ln50">        node.prev = head;</span>
<span data-line="ln51">        head.next.prev = node;</span>
<span data-line="ln52">        head.next = node;</span>
<span data-line="ln53">    }</span>

<span data-line="ln54">    private void delete(Node node) {</span>
<span data-line="ln55">        node.prev.next = node.next;</span>
<span data-line="ln56">        node.next.prev = node.prev;</span>
<span data-line="ln57">    }</span>
<span data-line="ln58">}</span></code></pre>
      </div>
    </div>
  </div>

  <script>
    // Sound toggle functionality
    document.addEventListener('DOMContentLoaded', () => {
      const soundToggle = document.getElementById('soundToggle');
      const soundIcon = document.getElementById('soundIcon');
      
      soundToggle.addEventListener('change', () => {
        const enabled = soundManager.toggle();
        soundIcon.className = enabled ? 'fas fa-volume-up sound-icon' : 'fas fa-volume-mute sound-icon';
        
        if (enabled) {
          soundManager.playSound('hit'); // Test sound
        }
      });
    });
  </script>
  <script src="app.js"></script>
</body>
</html>